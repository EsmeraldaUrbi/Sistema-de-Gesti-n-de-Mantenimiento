{% extends "base.html" %}
{% block content %}

<h1 class="page-title">Historial de Mantenimientos</h1>

<!-- Botón de exportación -->
<div class="boton-superior">
    <a href="/exportar_historial" class="btn-principal btn-success">
        Exportar historial a CSV
    </a>
</div>

{% if historial %}
<div class="table-container">
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Equipo</th>
                <th>Prioridad</th>
                <th>Fecha creación</th>
                <th>Fecha cierre</th>
                <th>Descripción</th>
                <th>Observaciones</th>
            </tr>
        </thead>

        <tbody>
            {% for h in historial %}
            <tr>
                <td>{{ h.id }}</td>
                <td>{{ h.equipo }}</td>
                <td>{{ h.prioridad }}</td>
                <td>{{ h.fecha_creacion.strftime('%d/%m/%Y') }}</td>
                <td>{{ h.fecha_cierre.strftime('%d/%m/%Y') if h.fecha_cierre else '-' }}</td>
                <td>{{ h.descripcion or '-' }}</td>
                <td>{{ h.observaciones or '-' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% else %}
<p style="margin-top:20px;">No hay tareas completadas registradas todavía.</p>
{% endif %}

{% endblock %}
